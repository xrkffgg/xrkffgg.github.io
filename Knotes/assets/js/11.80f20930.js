(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{188:function(e,t,a){"use strict";a.r(t);var r=a(0),n=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"_3-vue-elementå‰ç«¯å¯¼å…¥å¯¼å‡ºexcel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-vue-elementå‰ç«¯å¯¼å…¥å¯¼å‡ºexcel","aria-hidden":"true"}},[e._v("#")]),e._v(" 3. Vue+Elementå‰ç«¯å¯¼å…¥å¯¼å‡ºExcel")]),e._v(" "),a("h2",{attrs:{id:"_1-å‰è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-å‰è¨€","aria-hidden":"true"}},[e._v("#")]),e._v(" 1 å‰è¨€")]),e._v(" "),a("h3",{attrs:{id:"_1-1-ä¸šåŠ¡åœºæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-ä¸šåŠ¡åœºæ™¯","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.1 ä¸šåŠ¡åœºæ™¯")]),e._v(" "),a("p",[e._v("ç”±å‰å°å¯¼å…¥Excelè¡¨æ ¼ï¼Œè·å–æ‰¹é‡æ•°æ®ã€‚")]),e._v(" "),a("p",[e._v("æ ¹æ®ä¸€ä¸ªæ•°ç»„å¯¼å‡ºExcelè¡¨æ ¼ã€‚")]),e._v(" "),a("h2",{attrs:{id:"_2-å®ç°åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-å®ç°åŸç†","aria-hidden":"true"}},[e._v("#")]),e._v(" 2 å®ç°åŸç†")]),e._v(" "),a("h3",{attrs:{id:"_2-1-å¼•å…¥å·¥å…·åº“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-å¼•å…¥å·¥å…·åº“","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.1 å¼•å…¥å·¥å…·åº“")]),e._v(" "),a("blockquote",[a("p",[e._v("file-saverã€xlsxã€script-loader")])]),e._v(" "),a("p",[a("code",[e._v("npm install -S file-saver xlsx")])]),e._v(" "),a("p",[a("code",[e._v("npm install -D script-loader")])]),e._v(" "),a("h3",{attrs:{id:"_2-2-å¯¼å…¥excel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-å¯¼å…¥excel","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.2 å¯¼å…¥Excel")]),e._v(" "),a("h4",{attrs:{id:"_2-2-1-element-ä¸Šä¼ æ§ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-element-ä¸Šä¼ æ§ä»¶","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.2.1 Element ä¸Šä¼ æ§ä»¶")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/xrkffgg/Kimg/blob/master/blog/03-1.png?raw=true",alt:""}})]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<el-upload\n    class="upload-demo"\n    action=""\n    :on-change="handleChange"\n    :on-exceed="handleExceed"\n    :on-remove="handleRemove"\n    :file-list="fileListUpload"\n    :limit="limitUpload"\n    accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"\n    :auto-upload="false">\n    <el-button size="small" type="primary">ç‚¹å‡»ä¸Šä¼ </el-button>\n    <div slot="tip" class="el-upload__tip">åª èƒ½ ä¸Š ä¼  xlsx / xls æ–‡ ä»¶</div>\n</el-upload>\n')])])]),a("p",[a("code",[e._v("limitUpload = 1")]),e._v("é™åˆ¶åªèƒ½ä¸Šä¼ 1ä¸ªæ–‡ä»¶")]),e._v(" "),a("p",[a("code",[e._v("accept")]),e._v("ä¸ºé»˜è®¤æ‰“å¼€çš„å¯ä¸Šä¼ çš„æ–‡ä»¶æ ¼å¼")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("handleChange(file, fileList){\n    this.fileTemp = file.raw\n},\n\nhandleRemove(file,fileList){\n    this.fileTemp = null\n},\n")])])]),a("p",[a("code",[e._v("fileTemp")]),e._v("è¿™é‡Œå®šä¹‰äº†ä¸€ä¸‹å˜é‡ï¼ŒæŒ‡å‘æœ€æ–°ä¸Šä¼ çš„é™„ä»¶ï¼Œèµ·å§‹å®šä¹‰ä¸ºnullã€‚")]),e._v(" "),a("p",[e._v("è¿™é‡Œå‘ç°æ§ä»¶"),a("code",[e._v("file.raw")]),e._v("æ˜¯æˆ‘ä»¬è¦ç”¨çš„"),a("code",[e._v("File")]),e._v("ç±»å‹ã€‚")]),e._v(" "),a("h4",{attrs:{id:"_2-2-2-å¯¼å…¥åˆ¤æ–­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-å¯¼å…¥åˆ¤æ–­","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.2.2 å¯¼å…¥åˆ¤æ–­")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("if(this.fileTemp){\n    if((this.fileTemp.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') || (this.fileTemp.type == 'application/vnd.ms-excel')){\n        this.importfxx(this.fileTemp)\n    } else {\n        this.$message({\n            type:'warning',\n            message:'é™„ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·åˆ é™¤åé‡æ–°ä¸Šä¼ ï¼'\n        })\n    }\n} else {\n    this.$message({\n        type:'warning',\n        message:'è¯·ä¸Šä¼ é™„ä»¶ï¼'\n    })\n}\n")])])]),a("h4",{attrs:{id:"_2-2-3-å¯¼å…¥å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-å¯¼å…¥å‡½æ•°","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.2.3 å¯¼å…¥å‡½æ•°")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("importfxx(obj) {\n    let _this = this;\n    // é€šè¿‡DOMå–æ–‡ä»¶æ•°æ®\n    this.file = obj\n    var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²\n    var f = this.file;\n    var reader = new FileReader();\n    //if (!FileReader.prototype.readAsBinaryString) {\n    FileReader.prototype.readAsBinaryString = function(f) {\n        var binary = \"\";\n        var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²\n        var pt = this;\n        var wb; //è¯»å–å®Œæˆçš„æ•°æ®\n        var outdata;\n        var reader = new FileReader();\n        reader.onload = function(e) {\n        var bytes = new Uint8Array(reader.result);\n        var length = bytes.byteLength;\n        for(var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i]);\n        }\n        var XLSX = require('xlsx');\n        if(rABS) {\n            wb = XLSX.read(btoa(fixdata(binary)), { //æ‰‹åŠ¨è½¬åŒ–\n                type: 'base64'\n            });\n        } else {\n            wb = XLSX.read(binary, {\n                type: 'binary'\n            });\n        }\n        outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);//outdataå°±æ˜¯ä½ æƒ³è¦çš„ä¸œè¥¿\n            this.da = [...outdata]\n            let arr = []\n            this.da.map(v => {\n                let obj = {}\n                obj.code = v['è®¾å¤‡ID']\n                obj.type = v['è®¾å¤‡å‹å·']\n                arr.push(obj)\n            })\n            return arr\n        }\n        reader.readAsArrayBuffer(f);\n    }\n    \n    if(rABS) {\n        reader.readAsArrayBuffer(f);\n    } else {\n        reader.readAsBinaryString(f);\n    }\n},\n")])])]),a("p",[a("code",[e._v("arr")]),e._v("å°±æ˜¯æˆ‘ä»¬è¦çš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ¯ä¸€ä¸ªå€¼æ˜¯ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†"),a("code",[e._v("code")]),e._v(" "),a("code",[e._v("type")]),e._v("ä¸¤ä¸ªå±æ€§ã€‚")]),e._v(" "),a("p",[e._v("excelä¸­æ ¼å¼ä¸ºæ¨ªå‘ è®¾å¤‡ID å’Œ è®¾å¤‡å‹å·ã€‚")]),e._v(" "),a("h3",{attrs:{id:"_2-3-å¯¼å‡ºexcel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-å¯¼å‡ºexcel","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.3 å¯¼å‡ºExcel")]),e._v(" "),a("h4",{attrs:{id:"_2-3-1-å¼•å…¥jsæ–‡ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-å¼•å…¥jsæ–‡ä»¶","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.3.1 å¼•å…¥JSæ–‡ä»¶")]),e._v(" "),a("p",[e._v("å¯å‚è€ƒä¸‹è½½åœ°å€ï¼š- "),a("a",{attrs:{href:"https://github.com/xrkffgg/tools/tree/master/JS/Excel",target:"_blank",rel:"noopener noreferrer"}},[e._v("github"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("å°†å…¶ä¸­çš„2ä¸ªJSæ–‡ä»¶æ”¾å…¥åˆ°è‡ªå·±çš„å·¥ç¨‹ä¸­ã€‚")]),e._v(" "),a("h4",{attrs:{id:"_2-3-2-ä¿®æ”¹jsæ–‡ä»¶ä¸­åœ°å€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-ä¿®æ”¹jsæ–‡ä»¶ä¸­åœ°å€","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.3.2 ä¿®æ”¹JSæ–‡ä»¶ä¸­åœ°å€")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/xrkffgg/Kimg/blob/master/blog/03-2.png?raw=true",alt:""}}),e._v("\næ‰“å¼€"),a("code",[e._v("Export2Excel.js")]),e._v("ï¼Œä¼šå‡ºç°å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç”±äºæœ¬äººå°†"),a("code",[e._v("Blob.js")]),e._v("å’Œ"),a("code",[e._v("Export2Excel.js")]),e._v("æ”¾åˆ°äº†åŒä¸€çº§ï¼Œè¿™é‡Œå¼•å…¥æ˜¯è¿™æ ·çš„ã€‚")]),e._v(" "),a("p",[e._v("è¿™å‡ ä¸ªæ–‡ä»¶ä¸æ”¯æŒimportå¼•å…¥ï¼Œæ‰€ä»¥éœ€è¦"),a("code",[e._v("script-loader")]),e._v("æ¥å°†ä»–ä»¬æŒ‚è½½åˆ°å…¨å±€ç¯å¢ƒä¸‹ã€‚")]),e._v(" "),a("h4",{attrs:{id:"_2-3-3-å¯¼å‡ºå‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-3-å¯¼å‡ºå‡½æ•°","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.3.3 å¯¼å‡ºå‡½æ•°")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("getExcel(res) {\n    require.ensure([], () => {\n        const { export_json_to_excel } = require('../../introduce/Export2Excel.js')\n        const tHeader = ['å§“å', 'å¹´é¾„']\n        const filterVal = ['name', 'age']\n        const list = res\n        const data = this.formatJson(filterVal, list)\n        export_json_to_excel(tHeader, data, 'å¯¼å‡ºåˆ—è¡¨åç§°')\n    })\n},\n\nformatJson(filterVal, jsonData) {\n    return jsonData.map(v => filterVal.map(j => v[j]))\n},\n")])])]),a("p",[e._v("è¿™é‡Œçš„å¼•ç”¨è¯·æ ¹æ®è‡ªå·±çš„å±‚çº§å…³ç³»å’Œæ–‡ä»¶å¤¹å‘½å"),a("code",[e._v("require('../../introduce/Export2Excel.js')")])]),e._v(" "),a("p",[a("code",[e._v("res")]),e._v("ä¸ºä¼ å…¥çš„æ•°ç»„ï¼Œæ ¼å¼å¦‚ï¼š"),a("code",[e._v("res =[{name:'å°ç™½',age:'18'},{name:'å°é»‘',age:'16'}]")])]),e._v(" "),a("p",[a("code",[e._v("tHeader")]),e._v("ä¸ºå¯¼å‡ºExcelè¡¨å¤´åç§°ï¼Œ"),a("code",[e._v("å¯¼å‡ºåˆ—è¡¨åç§°")]),e._v("å³ä¸ºå¯¼å‡ºExcelåç§°")]),e._v(" "),a("p",[e._v("ä¸‹è½½çš„Excelä½ç½®æ ¹æ®æµè§ˆå™¨è®¾ç½®çš„ä¸‹è½½ä½ç½®è€Œå®š")]),e._v(" "),a("h2",{attrs:{id:"_3-åè®°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-åè®°","aria-hidden":"true"}},[e._v("#")]),e._v(" 3 åè®°")]),e._v(" "),a("p",[a("strong",[e._v("æ„Ÿè°¢æ”¯æŒã€‚è‹¥ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿å¤§å®¶æŒ‡å‡ºï¼Œå…±å‹‰ã€‚")])]),e._v(" "),a("p",[a("strong",[e._v("å¦‚æœè§‰å¾—ä¸é”™ï¼Œè®°å¾— ç‚¹èµ ï¼Œè°¢è°¢å¤§å®¶")]),e._v(" ğŸ˜‚")]),e._v(" "),a("blockquote",[a("p",[a("strong",[e._v("æ¬¢è¿å…³æ³¨ æˆ‘çš„ï¼š")]),e._v(" "),a("a",{attrs:{href:"https://github.com/xrkffgg/Tools",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Githubã€‘"),a("OutboundLink")],1),a("a",{attrs:{href:"https://juejin.im/user/59c369496fb9a00a4843a3e2/posts",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€æ˜é‡‘ã€‘"),a("OutboundLink")],1),a("a",{attrs:{href:"https://www.jianshu.com/u/4ca4daac5890",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ç®€ä¹¦ã€‘"),a("OutboundLink")],1),a("a",{attrs:{href:"https://blog.csdn.net/xrk_ffgg",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€CSDNã€‘"),a("OutboundLink")],1),a("a",{attrs:{href:"https://my.oschina.net/xrkffgg",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€OSCHINAã€‘"),a("OutboundLink")],1),a("a",{attrs:{href:"https://segmentfault.com/u/xrkffgg/articles",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€SFã€‘"),a("OutboundLink")],1)])]),e._v(" "),a("h3",{attrs:{id:"_3-1-å‚è€ƒèµ„æ–™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-å‚è€ƒèµ„æ–™","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.1 å‚è€ƒèµ„æ–™")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/liguiwang/p/8430672.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.cnblogs.com/liguiwang.."),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/qiu-Ann/p/7743897.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.cnblogs.com/qiu..."),a("OutboundLink")],1)])])])},[],!1,null,null,null);t.default=n.exports}}]);